'''
# ๐ ุชูุซูู ุงููุธุงู ุงููุญุฏุซ (B36 v33)

ูุฐุง ุงููุณุชูุฏ ููุฏู ุชูุซููุงู ุดุงููุงู ููุชุญุฏูุซุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุนูู ูุธุงู ุฅุฏุงุฑุฉ ุชุฏูู ุงููุฑุดุญููุ ููุดูู ุดุฑุญุงู ููุฃุฏูุงุฑ ูุงูุตูุงุญูุงุชุ ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจุงุช (ุงูุงูุชูุงูุงุช)ุ ููุนุงููุฑ ุงููุจูู.

---

## 1. ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช (Roles & Permissions)

ุชู ุชุทุจูู ูุธุงู ุตูุงุญูุงุช ูุญูู (RBAC) ูุนุชูุฏ ุนูู 6 ุฃุฏูุงุฑ ุซุงุจุชุฉ. ูุชู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (UI)ุ ููุทู ุงูุชุทุจูู (Frontend Logic)ุ ูููุงุนุฏ ุจูุงูุงุช Firestore (Backend) ูุถูุงู ุฃูุตู ุฏุฑุฌุงุช ุงูุฃูุงู (Defense in Depth).

### ููุฎุต ุงูุฃุฏูุงุฑ

| ุงูุฏูุฑ | ุงููุตู | ูุทุงู ุงูุนูู |
|---|---|---|
| **Admin** | ุงููุฏูุฑ ุงูุนุงู | ูุตูู ูุงูู ููู ุดูุก ูู ุงููุธุงู ุจุฏูู ูููุฏ. |
| **InternalSupervisor** | ูุดุฑู ุงููุจูู | ุฅุฏุงุฑุฉ ูุงููุฉ ูููุงุนุงุช ูุงูุทูุจุงุช ุงูุฏุงุฎููุฉุ ูุฅูุดุงุก ุทูุจุงุช ุงูุชูุงุฒู. |
| **InternalUser** | ููุธู ุฏุงุฎูู ุนุงุฏู | ูุจูู ููุตุงุฏูุฉ ุงูุทูุจุงุช ูููุงุนุงุช ุงูููุนููู ุนูููุง ููุท. |
| **ExternalSupervisor** | ููุธู ุฎุงุฑุฌู ูุดุฑู | ุฅุฏุงุฑุฉ ุงูุนุฏุฏ ุงูุฎุงุฑุฌู ูุฅูุดุงุก ุทูุจุงุช ุงูููู ูู ุงูุฎุงุฑุฌ ุฅูู ูุงุนุงุช ุงูุงูุชุธุงุฑ. |
| **ExternalUser** | ููุธู ุฎุงุฑุฌู ุนุงุฏู | ุชุญุฏูุซ ุงูุนุฏุฏ ุงูุฎุงุฑุฌู ููุท. |
| **Viewer** | ุนุงุฑุถ | ุนุฑุถ ููุญุฉ ุงูุชุญูู (Dashboard) ูุงูุฅุญุตุงุฆูุงุช ููุท (Read-only). |
| **Path Organizer** | ููุธู ุงููุณุงุฑ | ุฏูุฑ ุฎุงุต ููุณูุฏ ููุณุชุฎุฏู (ุนุงุฏุฉ `InternalUser`) ูุชูููุฐ ุนูููุงุช ุงูููู ุงููุนููุฉ ุจูู ุงููุงุนุงุช. |

### ูุตูููุฉ ุงูุตูุงุญูุงุช ุงูุชูุตูููุฉ

| ุงูุตูุงุญูุฉ | Admin | Internal<br>Supervisor | Internal<br>User | External<br>Supervisor | External<br>User | Viewer | Path<br>Organizer |
|:---|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| **ุฅุฏุงุฑุฉ ุงูุฃุนุฏุงุฏ** | | | | | | | |
| `COMMIT_HALL_COUNT` (ุงุนุชูุงุฏ ุนุฏุฏ ุงููุงุนุฉ) | โ | โ | ูููุงุนุชู | โ | โ | โ | โ |
| `MANAGE_OUTSIDE_COUNT` (ุฅุฏุงุฑุฉ ุงูุนุฏุฏ ุงูุฎุงุฑุฌู) | โ | โ | โ | โ | โ | โ | โ |
| **ุฅูุดุงุก ุงูุทูุจุงุช** | | | | | | | |
| `CREATE_OUTSIDE_TO_WAITING` | โ | โ | โ | โ | โ | โ | โ |
| `CREATE_WAITING_TO_INTERVIEW` | โ | โ | โ | โ | โ | โ | โ |
| `CREATE_INTERVIEW_TO_INTERVIEW` | โ | โ | โ | โ | โ | โ | โ |
| **ุฅุฌุฑุงุกุงุช ุงูุทูุจุงุช** | | | | | | | |
| `ACCEPT_REJECT_REQUEST` (ูุจูู/ุฑูุถ) | โ | โ | ูููุงุนุชู | โ | โ | โ | โ |
| `START_TRANSIT` (ุจุฏุก ุงูููู) | โ | โ | โ | โ | โ | โ | โ |
| `CONFIRM_ARRIVAL` (ูุตุงุฏูุฉ ุงููุตูู) | โ | โ | ูููุงุนุชู | โ | โ | โ | โ |
| `ASSIGN_PATH_ORGANIZER` | โ | โ | โ | โ | โ | โ | โ |
| **ุงูุฅุฏุงุฑุฉ ูุงูุนุฑุถ** | | | | | | | |
| `MANAGE_HALLS` (ุฅุฏุงุฑุฉ ุงููุงุนุงุช) | โ | โ | โ | โ | โ | โ | โ |
| `VIEW_DASHBOARD` (ุนุฑุถ ุงูุฏุงุดุจูุฑุฏ) | โ | โ | โ | โ | โ | โ | โ |
| `VIEW_ANALYTICS` (ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช) | โ | โ | โ | โ | โ | โ | โ |
| `VIEW_AUDIT_LOG` (ุนุฑุถ ุณุฌู ุงูุนูููุงุช) | โ | โ | โ | โ | โ | โ | โ |

---

## 2. ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจุงุช (State Transitions)

ุชู ุชุตููู ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจุงุช (State Machine) ูููุน ุชุถุงุฑุจ ุงูุฃุนุฏุงุฏ ูุถูุงู ุชุชุจุน ุฏููู ููู ุนูููุฉ ููู. **ุงูุฎุตู ูู ุงููุตุฏุฑ ูุญุฏุซ ูุฑุฉ ูุงุญุฏุฉ ููุท ุนูุฏ ุงูุงูุชูุงู ุฅูู `IN_TRANSIT`**.

### ูุฎุทุท ุงูุงูุชูุงูุงุช

```mermaid
graph TD
    A[Draft] -->|Submit| B(Pending)
    B -->|Accept| C(Accepted)
    B -->|Reject| D(Rejected)
    C -->|Start Transit| E(In Transit)
    E -->|Confirm Arrival| F(Arrived)
    F -->|Auto-Close| G(Closed)

    style A fill:#f3f4f6,stroke:#6b7280
    style B fill:#fef9c3,stroke:#f59e0b
    style C fill:#dcfce7,stroke:#22c55e
    style D fill:#fee2e2,stroke:#ef4444
    style E fill:#dbeafe,stroke:#3b82f6
    style F fill:#e0e7ff,stroke:#6366f1
    style G fill:#e5e7eb,stroke:#6b7280
```

### ุดุฑุญ ุงููุฑุงุญู

| ุงููุฑุญูุฉ | ุงูุญุงูุฉ | ุงููุตู | ุงูุฅุฌุฑุงุก ุงูุชุงูู |
|:---|:---|:---|:---|
| 1 | **Draft** | ูุชู ุฅูุดุงุก ุงูุทูุจ ููุณูุฏุฉ. ูููู ุชุนุฏููู ูุญุฐูู. | `Submit` (ุฅุฑุณุงู) |
| 2 | **Pending** | ุงูุทูุจ ุจุงูุชุธุงุฑ ููุงููุฉ ุงููุณุชูู (ูุณุคูู ุงููุงุนุฉ ุงููุฌูุฉ). | `Accept` ุฃู `Reject` |
| 3 | **Accepted** | ุชูุช ุงูููุงููุฉ ุนูู ุงูุทูุจ. ุจุงูุชุธุงุฑ ุจุฏุก ุนูููุฉ ุงูููู. | `Start Transit` |
| 4 | **Rejected** | ุชู ุฑูุถ ุงูุทูุจ. ุชุนุชุจุฑ ูุฐู ุญุงูุฉ ููุงุฆูุฉ. | ูุง ููุฌุฏ |
| 5 | **In Transit** | **(ููุทุฉ ุงูุฎุตู)** ูุชู ุงูุขู ููู ุงููุฑุดุญูู. ูุชู ุฎุตู `requestedCount` ูู ุงููุงุนุฉ ุงููุตุฏุฑ ุฃู ุงูุนุฏุฏ ุงูุฎุงุฑุฌู. | `Confirm Arrival` |
| 6 | **Arrived** | **(ููุทุฉ ุงูุฅุถุงูุฉ)** ูุตู ุงููุฑุดุญูู. ูุชู ุฅุถุงูุฉ `actualArrivedCount` ุฅูู ุงููุงุนุฉ ุงููุฌูุฉ. | `Auto-Close` |
| 7 | **Closed** | ุงูุชููุช ุนูููุฉ ุงูููู ูุชูุช ุงููุตุงุฏูุฉ ุนูููุง. ุชุนุชุจุฑ ูุฐู ุญุงูุฉ ููุงุฆูุฉ. | ูุง ููุฌุฏ |

### ุขููุฉ ููุน ุงูุฎุตู ุงููุฒุฏูุฌ (Double Decrement)

- **ุนูุฏ `Start Transit`**: ูุชู ุชูููุฐ ุนูููุฉ `increment(-requestedCount)` ุนูู ุงููุงุนุฉ ุงููุตุฏุฑ.
- **ุนูุฏ `Confirm Arrival`**: ูุชู ุชูููุฐ ุนูููุฉ `increment(actualArrivedCount)` ุนูู ุงููุงุนุฉ ุงููุฌูุฉ.
- **ูุง ููุฌุฏ ุฃู ุฎุตู ุฃู ุฅุถุงูุฉ ูู ุฃู ูุฑุญูุฉ ุฃุฎุฑู.** ูุฐุง ูุถูู ุฃู ูู ูุฑุดุญ ูุชู ุฎุตูู ูุฅุถุงูุชู ูุฑุฉ ูุงุญุฏุฉ ููุท ุฎูุงู ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจ.

---

## 3. ุงุฎุชุจุงุฑุงุช ุงููุจูู (Acceptance Criteria)

ุชู ุชุญุฏูุฏ ูุฌููุนุฉ ูู ุญุงูุงุช ุงูุงุฎุชุจุงุฑ ูุถูุงู ุฃู ุงููุธุงู ูุนูู ููุง ูู ูุชููุน ููุญูู ุฌููุน ุงููุชุทูุจุงุช ุงูุฃูููุฉ ูุงููุธูููุฉ. ูุฐู ุงูุงุฎุชุจุงุฑุงุช ูุฌุจ ุฃู ุชูุฌุญ ุฌููุนูุง ูุจู ุงุนุชูุงุฏ ุงููุธุงู.

1.  **ุตูุงุญูุงุช ูุทุงู ุงููุงุนุฉ (Hall Scope)**
    - **ุงูุณููุงุฑูู**: `InternalUser` ููุนููู ุนูู `Hall A` ูุญุงูู ูุจูู ุทูุจ ููุฌู ุฅูู `Hall B`.
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุชู ุฑูุถ ุงูุนูููุฉ ูุน ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ "ููุณ ูุฏูู ุตูุงุญูุฉ ููุชุนุงูู ูุน ูุฐุง ุงูุทูุจ".

2.  **ููุน ุงูุฎุตู ุงููุฒุฏูุฌ**
    - **ุงูุณููุงุฑูู**: ุฅูุดุงุก ุทูุจ ูููู 10 ูุฑุดุญูู. ูุชู ูุจูู ุงูุทูุจุ ุซู ุจุฏุก ุงููููุ ุซู ูุตุงุฏูุฉ ุงููุตูู.
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุชู ุฎุตู 10 ูู ุงููุงุนุฉ ุงููุตุฏุฑ **ููุท** ุนูุฏ ุจุฏุก ุงูููู. ูุง ูุญุฏุซ ุฃู ุชุบููุฑ ุขุฎุฑ ุนูู ุนุฏุฏ ุงููุงุนุฉ ุงููุตุฏุฑ.

3.  **ุตูุงุญูุงุช ุงูุนุงุฑุถ (Viewer)**
    - **ุงูุณููุงุฑูู**: ูุณุชุฎุฏู ุจุฏูุฑ `Viewer` ูุญุงูู ุงููุตูู ุฅูู ุฑุงุจุท ูุจุงุดุฑ ูุชุนุฏูู ูุงุนุฉ ุฃู ุทูุจ (ูุซูุงู: `/halls/edit/hall-1`).
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุชู ุฑูุถ ุงููุตูู ุนูู ูุณุชูู ุงูู API (Backend) ุญุชู ูู ุชููู ูู ุฑุคูุฉ ุงููุงุฌูุฉ.

4.  **ุงุนุชูุงุฏ ุงูุนุฏุฏ (Commit Count)**
    - **ุงูุณููุงุฑูู**: `InternalSupervisor` ูุบูุฑ ุงูุนุฏุฏ ูู `Hall C` ูู 50 ุฅูู 55 ุจุงุณุชุฎุฏุงู ุงูุนุฏุงุฏ ุงููุฏูู ููุถุบุท "ุงุนุชูุงุฏ".
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุชุบูุฑ `currentCount` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅูู 55ุ ููุชู ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ ูู `AuditLog` ููุซู ุงูุนูููุฉ (ูุจู: 50ุ ุจุนุฏ: 55).

5.  **ุฅูุฒุงููุฉ ุงูุชุนููู ุนูุฏ ูุฌูุฏ ูุฑู (Mismatch)**
    - **ุงูุณููุงุฑูู**: ุทูุจ ููู 10 ูุฑุดุญููุ ูููู ุชู ูุตุงุฏูุฉ ูุตูู 8 ููุท. ูุญุงูู ุงููุณุชูู ุชุฃููุฏ ุงููุตูู ุจุฏูู ูุชุงุจุฉ ุชุนููู.
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุชู ุฑูุถ ุงูุนูููุฉ ูุชุธูุฑ ุฑุณุงูุฉ ุชุทุงูุจู ุจุฅุฏุฎุงู ุชุนููู ูุณุจุจ ูููุฑู.

6.  **ุธููุฑ ุงูุฃุณูุงุก ูู ุจุทุงูุฉ ุงูุทูุจ**
    - **ุงูุณููุงุฑูู**: ุนุฑุถ ุชูุงุตูู ุฃู ุทูุจ ููู.
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุฌุจ ุฃู ุชุธูุฑ ุฃุณูุงุก ุงููุณุชุฎุฏููู ุจูุถูุญ ูู ุงูุญููู ุงูุชุงููุฉ: `Assigned By`, `Assigned To`, `Path Organizer` (ุฅู ูุฌุฏ), `Accepted By`, `Confirmed By`.

7.  **ุชุฌุงูุฒ ุงูุณุนุฉ ุจูุงุณุทุฉ ุงููุฏูุฑ**
    - **ุงูุณููุงุฑูู**: `Admin` ูุญุงูู ุงุนุชูุงุฏ ุนุฏุฏ ูู ูุงุนุฉ ูุชุฌุงูุฒ ุณุนุชูุง ุงููุตูู.
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ุชุธูุฑ ูุงูุฐุฉ ุชุทูุจ ููู ุฅุฏุฎุงู ุณุจุจ ุฅูุฒุงูู. ุจุนุฏ ุฅุฏุฎุงู ุงูุณุจุจุ ุชุชู ุงูุนูููุฉ ุจูุฌุงุญ.

8.  **ููุน ุชุฌุงูุฒ ุงูุณุนุฉ ุจูุงุณุทุฉ ุบูุฑ ุงููุฏูุฑ**
    - **ุงูุณููุงุฑูู**: `InternalSupervisor` ูุญุงูู ุงุนุชูุงุฏ ุนุฏุฏ ูุชุฌุงูุฒ ุงูุณุนุฉ.
    - **ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ูุชู ุฑูุถ ุงูุนูููุฉ ูุน ุฑุณุงูุฉ ุฎุทุฃ "ูุง ูููู ุชุฌุงูุฒ ุงูุณุนุฉ ุงููุตูู".
'''
